---
phase: 01.1-demo-visual-polish
plan: 02
type: execute
wave: 2
depends_on: ["01.1-01"]
files_modified:
  - website/cultural-map-redesign-stitch-lab/index-maplibre-chat-view.js
  - website/cultural-map-redesign-stitch-lab/index-maplibre-chat-widget.js
  - website/cultural-map-redesign-stitch-lab/index-maplibre-chat-controller.js
  - website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.css
  - website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.html
  - website/cultural-map-redesign-stitch-lab/index-maplibre-deeplink-bridge.js
autonomous: true

must_haves:
  truths:
    - "Opening the chat panel shows 4-6 clickable style cards (e.g. 'Weekend Getaway', 'Arts & Culture Day') that auto-submit a prompt when clicked"
    - "Chat FAB button matches the new design language (cream/gold/ink palette, not generic blue)"
    - "Clicking a bold place name inside a MUSE article section triggers the map to zoom to that asset and opens the detail panel"
    - "Place name links in MUSE content are visually distinct (bold, underlined, hover animation) so users know they're clickable"
    - "The deep-link bridge works for both chat responses and editorial content (shared utility)"
  artifacts:
    - path: "website/cultural-map-redesign-stitch-lab/index-maplibre-chat-view.js"
      provides: "Style card rendering in chat panel welcome state"
      contains: "style-card"
    - path: "website/cultural-map-redesign-stitch-lab/index-maplibre-deeplink-bridge.js"
      provides: "Shared utility for resolving asset names to pids and triggering map navigation"
      contains: "CulturalMapDeepLinkBridge"
    - path: "website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.css"
      provides: "Style card CSS, asset-link hover styles, chat FAB restyle"
      contains: "style-card"
  key_links:
    - from: "style card click"
      to: "chat controller submitMessage"
      via: "click handler calls CulturalMapChatController.submit(prompt)"
      pattern: "submit.*prompt"
    - from: "MUSE article asset-link click"
      to: "CulturalMapDeepLinkBridge.navigate"
      via: "delegated click on [data-asset-name]"
      pattern: "data-asset-name"
    - from: "CulturalMapDeepLinkBridge"
      to: "CulturalMapDetailController"
      via: "navigateFromChatAsset or equivalent"
      pattern: "navigateFromChatAsset|openDetailByName"
---

<objective>
AI Concierge style cards and editorial deep links — the "wow moment" features that no competitor has.

Purpose: Make the AI Concierge demo effortless (click a card, get a personalized itinerary) and make MUSE editorial content interactive (click a place name, see it on the map). These two features together form the centerpiece of the committee demo.

Output: Style cards in chat panel + restyled FAB + shared deep-link bridge + clickable asset names in MUSE content
</objective>

<execution_context>
@C:/Users/ender/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ender/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/01.1-demo-visual-polish/01.1-CONTEXT.md
@.planning/phases/01.1-demo-visual-polish/01.1-01-SUMMARY.md
@.planning/analysis/PRIORITIZED-ACTION-PLAN.md
@website/cultural-map-redesign-stitch-lab/index-maplibre-chat-view.js
@website/cultural-map-redesign-stitch-lab/index-maplibre-chat-widget.js
@website/cultural-map-redesign-stitch-lab/index-maplibre-chat-controller.js
@website/cultural-map-redesign-stitch-lab/index-maplibre-detail-controller.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add AI Concierge style cards and restyle chat FAB</name>
  <files>
    website/cultural-map-redesign-stitch-lab/index-maplibre-chat-view.js
    website/cultural-map-redesign-stitch-lab/index-maplibre-chat-widget.js
    website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.css
  </files>
  <action>
    **Style cards in chat panel (modify chat-view.js):**
    1. In the chat view's initial/welcome state (before any messages are sent), render 4-6 style cards. Each card is a clickable button with:
       - An emoji or icon (e.g. compass, palette, utensils, family, moon, camera)
       - A title (e.g. "Weekend Getaway", "Arts & Culture Day", "Family Adventure", "Foodie Tour", "Date Night", "Photo Walk")
       - A subtitle hint (e.g. "2 days exploring downtown galleries and dining")
    2. Cards should be in a 2-column grid inside the chat panel's message area.
    3. When a card is clicked:
       - The card's pre-built prompt is injected into the chat input (e.g. "Plan a weekend getaway in Nevada County focused on art galleries, local restaurants, and live music")
       - Auto-submit the prompt (call the chat controller's submit function)
       - Cards disappear and are replaced by the chat conversation flow
    4. If the chat panel is closed and reopened with no conversation history, cards reappear.
    5. Card prompts should be rich enough to trigger good Gemini responses with specific venue names from the knowledge pack. Examples:
       - "Weekend Getaway": "Plan a 2-day weekend in Nevada County. Include downtown galleries in Nevada City, a great dinner spot in Grass Valley, and a morning coffee recommendation. Mention specific places by name."
       - "Arts & Culture Day": "I have one day to experience the best arts and culture in Nevada County. What galleries, studios, and performances should I see? Include specific venue names and neighborhoods."
       - "Family Adventure": "Plan a family-friendly day in Nevada County with kids. Include outdoor activities, kid-friendly restaurants, and things to do in Grass Valley and Nevada City. Name specific places."
       - "Foodie Tour": "I'm a food lover visiting Nevada County. Map out my perfect day of eating — breakfast, lunch, dinner, and coffee. Name specific restaurants and cafes in Grass Valley and Nevada City."

    **Restyle chat FAB (modify chat-widget.js + CSS):**
    1. Change the FAB from generic chat bubble to match design language:
       - Background: gold (#c8943e) with cream icon
       - Hover: slightly darker gold
       - Size: 52px circle
       - Shadow: subtle (0 2px 8px rgba(0,0,0,0.15))
       - Icon: simple chat bubble SVG in cream color, not text
    2. Keep FAB position: bottom-right corner, 20px from edges.
    3. Add a subtle entrance animation: scale from 0 to 1 with 0.3s ease after page load (delay 2 seconds so the page settles first).

    **CSS for style cards:**
    1. `.chat-style-cards` — display: grid, grid-template-columns: 1fr 1fr, gap: 10px, padding: 16px.
    2. `.chat-style-card` — background: white, border: 1px solid #e0ddd5, border-radius: 12px, padding: 14px, cursor: pointer, text-align: left. Hover: border-color gold, subtle shadow lift.
    3. `.chat-style-card-icon` — font-size: 1.5rem, margin-bottom: 6px.
    4. `.chat-style-card-title` — DM Sans 600, 0.9rem, color: ink.
    5. `.chat-style-card-hint` — DM Sans 400, 0.75rem, color: #666, margin-top: 4px.
    6. On mobile (chat goes full-screen), cards should still be 2-column but with smaller padding.
  </action>
  <verify>
    1. Click the chat FAB — panel opens showing 4-6 style cards in a grid
    2. Click "Weekend Getaway" card — prompt auto-submits, conversation begins
    3. Close and reopen chat (without prior conversation) — cards reappear
    4. FAB is gold/cream colored, appears with subtle scale animation
    5. Cards disappear once conversation starts
    6. No console errors
  </verify>
  <done>Chat panel shows 4-6 style cards on open, clicking a card auto-submits a rich prompt, FAB matches gold/cream design language, cards reappear on fresh open</done>
</task>

<task type="auto">
  <name>Task 2: Create deep-link bridge and wire MUSE editorial asset links</name>
  <files>
    website/cultural-map-redesign-stitch-lab/index-maplibre-deeplink-bridge.js
    website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.html
    website/cultural-map-redesign-stitch-lab/index-maplibre-hero-intent-stitch-frontend-design-pass.css
    website/cultural-map-redesign-stitch-lab/index-maplibre-chat-controller.js
  </files>
  <action>
    **New file: `index-maplibre-deeplink-bridge.js`**
    Create an IIFE exposing `window.CulturalMapDeepLinkBridge`:
    1. `navigate({name})` — the core function. Takes an asset name string. Resolves name to a pid using fuzzy match against `window.CulturalMapConfig.PLACES` or the loaded data.json. Then calls `window.CulturalMapDeepLink.navigateFromChatAsset({pid, name})` if that exists, or falls back to direct map flyTo + detail panel open.
    2. `init()` — sets up a delegated click handler on `document.body` for `[data-asset-name]` elements:
       ```js
       document.body.addEventListener('click', function(e) {
         var link = e.target.closest('[data-asset-name]');
         if (link) {
           e.preventDefault();
           CulturalMapDeepLinkBridge.navigate({name: link.getAttribute('data-asset-name')});
         }
       });
       ```
    3. Extract the fuzzy name-to-pid matching from `index-maplibre-chat-controller.js` (the `handleAssetClick` or equivalent function) into this bridge so it's reusable. The chat controller should then call the bridge instead of doing its own resolution.

    **HTML changes — add `data-asset-name` attributes to MUSE section:**
    1. In the `#muse` section, find place names mentioned in the MUSE card bodies. Wrap each place name in a `<a class="asset-link" data-asset-name="Place Name" href="#">Place Name</a>` tag.
    2. Target these places (they appear in the MUSE text and exist in data.json):
       - Empire Mine State Historic Park
       - North Columbia Schoolhouse Cultural Center
       - Crystal Rainbow Rock Shop
       - Communal Cafe
       - Mother Truckers
       - Bear Yuba Land Trust
       - Neighborhood Center of the Arts
       - Mountain Brew Coffee
       - Truckee River Winery
       - The Pour House
       - Mountain Arts Collective
       - Piper J Gallery
       - Riverside Studios
       - Pastime Club
       - Washington Hotel
    3. Not all of these may exist in data.json — only wire the ones that do. Check `data.json` for matches. If a place is NOT in data.json, leave it as plain text (do not add `data-asset-name`).

    **Modify chat controller:**
    1. Refactor the existing `handleAssetClick` / `navigateFromChatAsset` to delegate to `CulturalMapDeepLinkBridge.navigate()` instead of doing its own fuzzy matching. Keep backward compatibility — if the bridge isn't loaded, fall back to existing behavior.

    **CSS for asset links:**
    1. `.asset-link` — color: ink (#1a1612), font-weight: 700, text-decoration: underline, text-decoration-color: gold (#c8943e), text-underline-offset: 3px.
    2. `.asset-link:hover` — color: gold, text-decoration-color: ink. Transition: 0.2s ease.
    3. Optional: add a small map-pin icon after the link via `::after` pseudo-element (subtle, 12px).

    **HTML — add script tag:**
    Add `<script src="index-maplibre-deeplink-bridge.js"></script>` after `index-maplibre-detail-controller.js` and before `index-maplibre-page-effects.js` in the load order. Call `CulturalMapDeepLinkBridge.init()` from bindings or the main init script.
  </action>
  <verify>
    1. In the MUSE section, place names appear as bold underlined links with gold accent
    2. Click a wired place name (e.g. "Empire Mine State Historic Park") — map zooms to location, detail panel opens
    3. Open AI Concierge, ask a question, click a place name in the response — same behavior (bridge handles both)
    4. Place names NOT in data.json remain plain text (no broken links)
    5. No console errors
  </verify>
  <done>MUSE article place names are clickable asset links that trigger map zoom + detail panel; deep-link bridge is shared between chat and editorial content; asset links are visually distinct with bold + gold underline</done>
</task>

</tasks>

<verification>
1. Open chat FAB → style cards visible in 2-column grid
2. Click a style card → prompt submits, conversation begins with specific venue recommendations
3. Click a venue name in the AI response → map zooms, detail panel opens
4. Close chat, scroll to MUSE section, click a wired place name → same map + detail behavior
5. Asset links in MUSE are visually bold with gold underline
6. FAB is gold/cream, appears with subtle animation
7. All existing chat functionality still works (typing, sending, response streaming)
8. No console errors
</verification>

<success_criteria>
The "wow moment" demo flow works end-to-end: open chat → click style card → AI responds with places → click a place → map zooms. Also: MUSE articles have interactive place links. Committee sees the AI and editorial content connected to the map in a way no competitor offers.
</success_criteria>

<output>
After completion, create `.planning/phases/01.1-demo-visual-polish/01.1-02-SUMMARY.md`
</output>
