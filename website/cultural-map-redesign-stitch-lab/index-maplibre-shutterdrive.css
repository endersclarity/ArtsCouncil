/*
  Shutterdrive visual layer for index-maplibre-shutterdrive.html.
  Keeps DOM hooks/scripts unchanged while applying a distinct editorial film look.
*/

:root {
  --sd-bg: oklch(95% 0.02 78);
  --sd-bg-alt: oklch(90% 0.03 85);
  --sd-surface: oklch(98% 0.01 90);
  --sd-surface-strong: oklch(87% 0.03 76);
  --sd-ink: oklch(24% 0.025 55);
  --sd-muted: oklch(36% 0.03 55);
  --sd-line: oklch(34% 0.03 56 / 0.24);
  --sd-accent-gold: oklch(74% 0.16 82);
  --sd-accent-cyan: oklch(64% 0.11 225);
  --sd-accent-rust: oklch(61% 0.17 42);
  --sd-accent-leaf: oklch(58% 0.1 150);
  --sd-shadow-soft: 0 20px 42px oklch(20% 0.02 55 / 0.16);
  --sd-shadow-card: 0 8px 20px oklch(20% 0.02 55 / 0.12);
  --sd-shadow-glow: 0 0 0 1px oklch(70% 0.12 224 / 0.28), 0 12px 22px oklch(70% 0.12 224 / 0.18);
}

body.shutterdrive-theme {
  --font-display: 'Fraunces', 'Times New Roman', serif;
  --font-body: 'Manrope', 'Segoe UI', sans-serif;
  --font-mono: 'Space Mono', monospace;

  --ink: var(--sd-ink);
  --cream: var(--sd-bg);
  --parchment: var(--sd-surface);
  --gold: var(--sd-accent-gold);
  --gold-bright: oklch(83% 0.2 86);
  --rust: var(--sd-accent-rust);
  --deep-green: var(--sd-accent-leaf);
  --slate: var(--sd-muted);
  --red-accent: var(--sd-accent-rust);
  --blue-wash: var(--sd-accent-cyan);

  --cat-landmarks: oklch(59% 0.16 42);
  --cat-eat: oklch(73% 0.16 80);
  --cat-arts: oklch(60% 0.11 155);
  --cat-cultural: oklch(61% 0.12 225);
  --cat-fairs: oklch(67% 0.17 50);
  --cat-galleries: oklch(52% 0.06 334);
  --cat-walks: oklch(56% 0.09 165);
  --cat-publicart: oklch(70% 0.17 35);
  --cat-performance: oklch(62% 0.14 235);
  --cat-preservation: oklch(50% 0.06 74);

  background:
    linear-gradient(100deg, oklch(93% 0.03 84 / 0.82), transparent 55%),
    radial-gradient(1200px 700px at 0% 0%, oklch(86% 0.04 83 / 0.55), transparent 62%),
    radial-gradient(900px 450px at 100% 0%, oklch(85% 0.05 228 / 0.34), transparent 62%),
    linear-gradient(180deg, var(--sd-bg), var(--sd-bg-alt) 44%, var(--sd-bg) 100%);
  color: var(--sd-ink);
  min-height: 100vh;
}

body.shutterdrive-theme::before {
  content: '';
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background-image:
    linear-gradient(to bottom, oklch(16% 0.02 55 / 0.04), transparent 12%, transparent 88%, oklch(16% 0.02 55 / 0.04)),
    repeating-linear-gradient(90deg, oklch(20% 0.02 55 / 0.035) 0 1px, transparent 1px 6px),
    repeating-linear-gradient(0deg, oklch(20% 0.02 55 / 0.02) 0 1px, transparent 1px 6px);
}

.shutterdrive-theme a {
  color: oklch(40% 0.11 225);
  text-decoration-thickness: 1.5px;
  text-underline-offset: 2px;
}

.shutterdrive-theme .hero {
  padding: 4.15rem 2.3rem 2.1rem;
  position: relative;
  overflow: hidden;
  isolation: isolate;
}

.shutterdrive-theme .hero::before,
.shutterdrive-theme .hero::after {
  content: '';
  position: absolute;
  border-radius: 0;
  pointer-events: none;
  filter: none;
}

.shutterdrive-theme .hero::before {
  width: min(44vw, 520px);
  height: 220px;
  background: repeating-linear-gradient(-18deg, oklch(22% 0.03 56 / 0.18) 0 8px, transparent 8px 16px);
  top: -68px;
  right: -100px;
  animation: shutterdriveFloat 11s ease-in-out infinite;
}

.shutterdrive-theme .hero::after {
  width: min(35vw, 420px);
  height: 170px;
  background: repeating-linear-gradient(15deg, oklch(67% 0.14 84 / 0.23) 0 10px, transparent 10px 19px);
  left: -80px;
  bottom: -32px;
  animation: shutterdriveFloat 12.5s ease-in-out -2.4s infinite;
}

.shutterdrive-theme .hero-badge {
  width: min(500px, 86vw);
  border-radius: 2px;
  padding: 0.28rem;
  background: oklch(97% 0.01 90);
  border: 2px solid oklch(25% 0.02 56 / 0.85);
  box-shadow: 10px 10px 0 oklch(20% 0.02 56 / 0.12);
}

.shutterdrive-theme .hero-content {
  max-width: 840px;
}

.shutterdrive-theme .hero-eyebrow {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
  padding: 0.25rem 0.65rem;
  border-radius: 2px;
  border: 1px solid oklch(25% 0.02 56 / 0.45);
  background: oklch(97% 0.01 90 / 0.82);
  color: oklch(30% 0.03 56);
  font-size: 0.6rem;
  letter-spacing: 0.11em;
  margin-bottom: 1.05rem;
}

.shutterdrive-theme .hero-title {
  font-size: clamp(2.05rem, 6vw, 4.35rem);
  line-height: 0.92;
  letter-spacing: -0.02em;
  margin-bottom: 0.8rem;
  text-wrap: balance;
  font-variation-settings: "SOFT" 100, "WONK" 1;
}

.shutterdrive-theme .hero-title em {
  font-style: italic;
  display: inline-block;
  color: oklch(52% 0.15 42);
}

.shutterdrive-theme .hero-sub {
  max-width: 820px;
  font-size: clamp(1.02rem, 2vw, 1.22rem);
  line-height: 1.58;
  color: oklch(36% 0.05 240);
}

.shutterdrive-theme .hero-instructions {
  margin-top: 0.92rem;
  font-size: 0.63rem;
  letter-spacing: 0.12em;
  color: oklch(44% 0.03 237);
}

.shutterdrive-theme .hero-flags {
  margin-top: 1.15rem;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.45rem;
}

.shutterdrive-theme .hero-flag {
  border-radius: 2px;
  border: 1px dashed oklch(26% 0.03 56 / 0.42);
  background: oklch(97% 0.01 90 / 0.75);
  padding: 0.22rem 0.68rem;
  font-family: var(--font-mono);
  font-size: 0.58rem;
  letter-spacing: 0.07em;
  text-transform: uppercase;
  color: oklch(32% 0.03 56);
}

.shutterdrive-theme .section-intro {
  max-width: 1180px;
  padding: 1.6rem 2.2rem 2.2rem;
}

.shutterdrive-theme .section-intro::before {
  background: linear-gradient(180deg, oklch(97% 0.01 90 / 0.9), oklch(91% 0.03 84 / 0.55));
}

.shutterdrive-theme .section-tag {
  color: oklch(35% 0.03 56);
  letter-spacing: 0.16em;
}

.shutterdrive-theme .section-heading {
  font-size: clamp(1.65rem, 3vw, 2.25rem);
  line-height: 1.04;
  max-width: 22ch;
}

.shutterdrive-theme .section-body {
  color: oklch(36% 0.04 236);
  max-width: 72ch;
}

.shutterdrive-theme .section-quicktip {
  border: 1px solid var(--sd-line);
  border-radius: 2px;
  background: oklch(97% 0.01 90 / 0.7);
  color: oklch(31% 0.03 56);
}

.shutterdrive-theme .section-quicktip-dot {
  background: oklch(62% 0.16 42);
}

.shutterdrive-theme .map-section {
  background: transparent;
}

.shutterdrive-theme .map-header {
  padding: 2rem 2rem 1.3rem;
}

.shutterdrive-theme .map-title {
  font-size: clamp(2rem, 4vw, 3.2rem);
  line-height: 0.93;
  letter-spacing: -0.01em;
}

.shutterdrive-theme .map-active-banner {
  padding: 0 2rem;
}

.shutterdrive-theme .map-active-banner-inner {
  background: oklch(98% 0.01 90 / 0.86);
  border: 1px dashed var(--sd-line);
  border-radius: 4px;
  padding: 0.55rem 0.7rem;
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .map-active-text {
  font-size: 0.62rem;
  letter-spacing: 0.09em;
  color: oklch(41% 0.04 240);
}

.shutterdrive-theme .map-active-clear {
  background: oklch(100% 0 0 / 0.72);
  border-radius: 999px;
  border: 1px solid var(--sd-line);
  color: oklch(36% 0.04 236);
}

.shutterdrive-theme .map-container {
  margin: 1.2rem clamp(1rem, 4vw, 2.1rem) 1.8rem;
  padding: 0.72rem;
  border: 2px solid oklch(26% 0.03 56 / 0.78);
  border-radius: 4px;
  background:
    linear-gradient(120deg, oklch(97% 0.01 90 / 0.82), oklch(91% 0.03 84 / 0.58)),
    linear-gradient(180deg, oklch(88% 0.04 230 / 0.24), transparent 36%);
  box-shadow: 14px 14px 0 oklch(20% 0.02 56 / 0.12);
}

.shutterdrive-theme #map {
  border-radius: 2px;
  box-shadow: inset 0 0 0 1px oklch(20% 0.02 56 / 0.2);
}

.shutterdrive-theme .map-overlay-controls {
  top: 1.65rem;
  left: 1.65rem;
  right: 1.65rem;
}

.shutterdrive-theme .map-filter-toggle,
.shutterdrive-theme .map-legend-toggle,
.shutterdrive-theme .map-location-refresh,
.shutterdrive-theme .map-location-status {
  border: 1px solid var(--sd-line);
  background: oklch(98% 0.01 90 / 0.84);
  box-shadow: var(--sd-shadow-card);
  color: oklch(29% 0.03 56);
  border-radius: 2px;
}

.shutterdrive-theme .map-filter-toggle {
  padding: 0.46rem 0.8rem 0.46rem 0.58rem;
  gap: 0.5rem;
  backdrop-filter: blur(7px);
  -webkit-backdrop-filter: blur(7px);
}

.shutterdrive-theme .map-filter-toggle-dot,
.shutterdrive-theme .map-location-dot,
.shutterdrive-theme .map-legend-dot {
  background: oklch(64% 0.16 223);
}

.shutterdrive-theme .map-filter-toggle-meta,
.shutterdrive-theme .map-location-status {
  font-size: 0.5rem;
  letter-spacing: 0.1em;
}

.shutterdrive-theme .map-filter-panel {
  max-width: min(1050px, calc(100vw - 130px));
}

.shutterdrive-theme .map-filter-panel .map-filter-bar,
.shutterdrive-theme .map-legend-panel {
  border: 1px solid var(--sd-line);
  border-radius: 2px;
  background: linear-gradient(140deg, oklch(97% 0.01 90 / 0.9), oklch(92% 0.03 85 / 0.72));
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .filter-pill {
  border: 1px solid var(--sd-line);
  background: oklch(97% 0.01 90 / 0.8);
  border-radius: 2px;
  padding: 0.42rem 0.76rem;
  box-shadow: none;
  color: oklch(30% 0.03 56);
}

.shutterdrive-theme .filter-pill:hover {
  transform: translateY(-2px);
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .filter-pill.active {
  border-color: oklch(58% 0.16 42 / 0.72);
  box-shadow: var(--sd-shadow-glow);
  color: oklch(25% 0.06 42);
}

.shutterdrive-theme .hours-legend-item,
.shutterdrive-theme .map-legend-item,
.shutterdrive-theme .map-filter-group-label {
  color: oklch(42% 0.04 237);
}

.shutterdrive-theme .map-guides,
.shutterdrive-theme .map-subaddon,
.shutterdrive-theme .map-events-details {
  border: 1px solid var(--sd-line);
  border-radius: 4px;
  background: linear-gradient(145deg, oklch(97% 0.01 90 / 0.8), oklch(91% 0.03 84 / 0.62));
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .map-guides > summary,
.shutterdrive-theme .map-subaddon > summary,
.shutterdrive-theme .map-events-details > summary {
  padding: 0.9rem 1rem;
}

.shutterdrive-theme .section-header {
  font-size: 1rem;
  letter-spacing: -0.01em;
}

.shutterdrive-theme .map-addon-count,
.shutterdrive-theme .map-events-count,
.shutterdrive-theme .map-events-page {
  color: oklch(41% 0.04 237);
}

.shutterdrive-theme .map-events-chip,
.shutterdrive-theme .map-events-category-select,
.shutterdrive-theme .map-events-nav {
  border: 1px solid var(--sd-line);
  background: oklch(100% 0 0 / 0.75);
  color: oklch(36% 0.04 236);
}

.shutterdrive-theme .map-events-chip.active {
  border-color: oklch(73% 0.18 84 / 0.7);
  color: oklch(33% 0.08 82);
  box-shadow: 0 0 0 1px oklch(73% 0.18 84 / 0.32);
}

.shutterdrive-theme .smart-label-card {
  border-radius: 2px;
  border: 1px solid var(--sd-line);
  border-left-width: 5px;
  background: oklch(98% 0.01 90 / 0.88);
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .maplibregl-ctrl-group {
  background: linear-gradient(180deg, oklch(26% 0.03 56), oklch(20% 0.02 56)) !important;
  border-radius: 2px !important;
  border: 1px solid oklch(16% 0.02 56 / 0.8) !important;
  overflow: hidden;
  box-shadow: 0 8px 18px oklch(15% 0.02 56 / 0.34) !important;
}

.shutterdrive-theme .maplibregl-ctrl-group button + button {
  border-top: 1px solid oklch(82% 0.03 240 / 0.2) !important;
}

.shutterdrive-theme .maplibregl-popup-content {
  border-radius: 3px !important;
  border: 2px solid oklch(26% 0.03 56 / 0.82) !important;
  background: linear-gradient(150deg, oklch(98% 0.01 90), oklch(92% 0.03 84)) !important;
  box-shadow: var(--sd-shadow-soft) !important;
}

.shutterdrive-theme .tooltip-body {
  background: transparent;
}

.shutterdrive-theme .tooltip-body strong {
  font-size: 0.9rem;
}

.shutterdrive-theme .muse-section {
  padding: 4rem 2rem 4.6rem;
  background: linear-gradient(180deg, oklch(93% 0.03 84 / 0.56), oklch(98% 0.01 90 / 0.82));
}

.shutterdrive-theme .muse-section::before {
  opacity: 0.14;
}

.shutterdrive-theme .muse-section-title {
  font-size: clamp(2rem, 4.2vw, 3.4rem);
  letter-spacing: -0.03em;
}

.shutterdrive-theme .muse-card {
  border: 1px solid var(--sd-line);
  border-radius: 3px;
  background: linear-gradient(145deg, oklch(98% 0.01 90 / 0.84), oklch(91% 0.03 84 / 0.62));
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .muse-card summary {
  padding: 1.4rem;
}

.shutterdrive-theme .muse-card-title {
  font-size: clamp(1.16rem, 2.3vw, 1.62rem);
}

.shutterdrive-theme .muse-card-quote {
  color: oklch(34% 0.04 238);
}

.shutterdrive-theme .explore-section {
  padding: 4rem 2rem 4.2rem;
}

.shutterdrive-theme .explore-section::before {
  background: linear-gradient(180deg, oklch(97% 0.01 90 / 0.86), oklch(91% 0.03 84 / 0.62));
}

.shutterdrive-theme .explore-header {
  gap: 1rem;
  align-items: end;
}

.shutterdrive-theme .explore-search {
  border-radius: 2px;
  border: 1px solid var(--sd-line);
  background: oklch(98% 0.01 90 / 0.82);
  color: var(--sd-ink);
  box-shadow: var(--sd-shadow-card);
}

.shutterdrive-theme .explore-categories,
.shutterdrive-theme .explore-list-wrapper,
.shutterdrive-theme .explore-item {
  border-radius: 3px;
}

.shutterdrive-theme .explore-cat-pill,
.shutterdrive-theme .load-more-btn,
.shutterdrive-theme .explore-list-back {
  border: 1px solid var(--sd-line);
  border-radius: 2px;
  background: linear-gradient(145deg, oklch(98% 0.01 90 / 0.84), oklch(92% 0.03 84 / 0.66));
}

.shutterdrive-theme .explore-cat-pill.active {
  border-color: oklch(70% 0.16 223 / 0.65);
  box-shadow: var(--sd-shadow-glow);
}

.shutterdrive-theme .detail-panel-overlay {
  background: oklch(16% 0.02 56 / 0.56);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
}

.shutterdrive-theme .detail-panel {
  border: 1px solid var(--sd-line);
  border-radius: 4px 4px 0 0;
  background: linear-gradient(155deg, oklch(98% 0.01 90), oklch(92% 0.03 84));
  box-shadow: 0 -12px 28px oklch(16% 0.02 56 / 0.24);
}

.shutterdrive-theme .detail-close {
  border: 1px solid var(--sd-line);
  border-radius: 2px;
  background: oklch(98% 0.01 90 / 0.84);
}

.shutterdrive-theme .colophon {
  padding: 4.2rem 2rem 3.6rem;
  background: linear-gradient(180deg, oklch(91% 0.03 84 / 0.72), oklch(97% 0.01 90));
}

.shutterdrive-theme .colophon-inner {
  border: 1px solid var(--sd-line);
  border-radius: 4px;
  padding: 2rem;
  background: linear-gradient(145deg, oklch(98% 0.01 90 / 0.8), oklch(91% 0.03 84 / 0.58));
  box-shadow: var(--sd-shadow-soft);
}

.shutterdrive-theme .colophon-heading {
  font-size: clamp(1.55rem, 2.9vw, 2.4rem);
}

.shutterdrive-theme .colophon-label {
  color: oklch(40% 0.05 236);
}

.shutterdrive-theme .colophon-rule {
  border-color: oklch(54% 0.08 235 / 0.22);
}

.shutterdrive-theme .colophon-bottom {
  gap: 0.8rem;
  flex-wrap: wrap;
}

.shutterdrive-theme .colophon-bottom a {
  border-radius: 2px;
  border: 1px solid var(--sd-line);
  background: oklch(98% 0.01 90 / 0.78);
  padding: 0.28rem 0.6rem;
  text-decoration: none;
}

.shutterdrive-theme .reveal {
  transition-timing-function: cubic-bezier(0.2, 0.8, 0.2, 1);
}

@keyframes shutterdriveFloat {
  0%, 100% { transform: translate3d(0, 0, 0); }
  50% { transform: translate3d(0, 12px, 0); }
}

@media (max-width: 1100px) {
  .shutterdrive-theme .map-overlay-controls {
    right: 1.2rem;
  }

  .shutterdrive-theme .map-filter-panel {
    max-width: calc(100vw - 95px);
  }
}

@media (max-width: 900px) {
  .shutterdrive-theme .hero {
    padding: 3.4rem 1.35rem 1.7rem;
  }

  .shutterdrive-theme .section-intro,
  .shutterdrive-theme .map-header,
  .shutterdrive-theme .map-active-banner,
  .shutterdrive-theme .muse-section,
  .shutterdrive-theme .explore-section,
  .shutterdrive-theme .colophon {
    padding-left: 1.2rem;
    padding-right: 1.2rem;
  }

  .shutterdrive-theme .map-container {
    margin-left: 1rem;
    margin-right: 1rem;
    height: 66vh;
  }

  .shutterdrive-theme .map-overlay-controls {
    top: 1rem;
    left: 1rem;
    right: 1rem;
  }

  .shutterdrive-theme .map-filter-toggle {
    font-size: 0.65rem;
    padding: 0.4rem 0.64rem;
  }

  .shutterdrive-theme .map-overlay-secondary {
    flex-direction: row;
    flex-wrap: wrap;
    gap: 0.35rem;
    max-width: 100%;
  }
}

@media (max-width: 640px) {
  .shutterdrive-theme .hero-title {
    font-size: clamp(1.72rem, 10.8vw, 2.6rem);
    line-height: 0.98;
  }

  .shutterdrive-theme .hero-sub {
    font-size: 0.96rem;
  }

  .shutterdrive-theme .hero-flags {
    justify-content: center;
  }

  .shutterdrive-theme .section-intro {
    padding-top: 1.2rem;
  }

  .shutterdrive-theme .map-title {
    font-size: clamp(1.55rem, 8vw, 2.1rem);
  }

  .shutterdrive-theme .map-container {
    min-height: 430px;
    height: 62vh;
    padding: 0.65rem;
    border-radius: 20px;
  }

  .shutterdrive-theme #map {
    border-radius: 14px;
  }

  .shutterdrive-theme .map-overlay-controls {
    position: absolute;
  }

  .shutterdrive-theme .map-overlay-secondary {
    margin-top: 0.24rem;
    width: 100%;
  }

  .shutterdrive-theme .map-location-status {
    max-width: 100%;
  }

  .shutterdrive-theme .muse-card summary,
  .shutterdrive-theme .colophon-inner {
    padding: 1.1rem;
  }
}

@media (prefers-reduced-motion: reduce) {
  .shutterdrive-theme *,
  .shutterdrive-theme *::before,
  .shutterdrive-theme *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
